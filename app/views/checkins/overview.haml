!!!
%html
  %head
    :css
      .chart {
        width: 100%;
      }
      
      .row {
        text-align: center;
        margin-bottom: 50px;
      }
      
      #overview_chart {
        height: 600px;
      }
      
      #geo_chart, 
      #state_chart {
        width: 1000px;
        height: 400px;
      }
      
      #abv_container {
        text-align: center;
        margin-left: 100px;
        margin-right: 100px;
      }
            
    %script{:type => "text/javascript", :src => "https://www.google.com/jsapi" }
    :javascript
      // Load the Visualization API and the piechart package.
      google.load('visualization', '1.0', {'packages':['corechart', 'geochart', 'gauge']});

      // Set a callback to run when the Google Visualization API is loaded.
      google.setOnLoadCallback(drawChart);

      function drawChart() {

        // Create the data table.
        
        var overview_data = google.visualization.arrayToDataTable(
          #{@count_by_day_data.to_json}        
        );
        
        var count_series = {
          targetAxisIndex: 0,
          type: 'bars'
        };
        var sum_series = { 
          targetAxisIndex: 1,
          type: 'line'
        };
        
        var overview_options = {
          title: 'Beers',
          series: {
            0: count_series,
            1: count_series,
            2: count_series,
            3: count_series,
            4: sum_series,
            5: sum_series,
            6: sum_series,
            7: sum_series
          },
          vAxes: [
            { title: "Daily Count"},
            { title: "Running Total"}
          ],
          colors: [
            'RED',
            'BLUE',
            'GREEN',
            'ORANGE'
          ]
        };

        var overview_chart = new google.visualization.LineChart(document.getElementById('overview_chart'));
        overview_chart.draw(overview_data, overview_options);
        
        var geo_data = google.visualization.arrayToDataTable(#{@geo_data.to_a.to_json});
        var geo_chart = new google.visualization.GeoChart(document.getElementById('geo_chart'));
        geo_chart.draw(geo_data, {});
        
        var state_data = google.visualization.arrayToDataTable(#{@state_data.to_a.to_json});
        var state_chart = new google.visualization.GeoChart(document.getElementById('state_chart'));
        state_chart.draw(state_data, { 
          region: 'US',
          resolution: 'provinces'
        });
        
        
        var abv_data = google.visualization.arrayToDataTable(#{@abv_data.to_a.to_json})
        var abv_chart = new google.visualization.Gauge(document.getElementById('abv_chart'));
        abv_chart.draw(abv_data, {
          min: 0,
          max: 10,
          yellowFrom: 5,
          yellowTo: 7,
          redFrom: 7,
          redTo: 10
        });          
      }

  %body
    .row
      %h2 Overview
      #overview_chart.chart

    #abv_container.row
      %h2 Average Alcohol By Volume (%)
      #abv_chart
      
        

    #geo_container.row
      %h2 Beers of the World (#)
      #state_chart.chart
      #geo_chart.chart
    